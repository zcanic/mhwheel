<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åˆ†äº«æŒ‰é’®é€»è¾‘æµ‹è¯•</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-zinc-100 p-8">
    <div class="max-w-md mx-auto space-y-4">
        <h1 class="text-2xl font-bold text-center mb-6">åˆ†äº«æŒ‰é’®æ˜¾ç¤ºé€»è¾‘æµ‹è¯•</h1>
        
        <div class="space-y-2">
            <label class="block text-sm font-medium">ç©å®¶æ•°é‡ï¼š</label>
            <input type="number" id="playerCount" min="1" max="4" value="2" 
                class="w-full px-3 py-2 border border-zinc-200 rounded-lg">
        </div>
        
        <div class="space-y-2">
            <label class="block text-sm font-medium">å·²åˆ†é…æ­¦å™¨çš„ç©å®¶æ•°é‡ï¼š</label>
            <input type="number" id="assignedCount" min="0" max="4" value="0" 
                class="w-full px-3 py-2 border border-zinc-200 rounded-lg">
        </div>
        
        <div class="space-y-2">
            <label class="flex items-center space-x-2">
                <input type="checkbox" id="isAssigning" 
                    class="rounded border-zinc-300">
                <span>æ­£åœ¨åˆ†é…ä¸­</span>
            </label>
        </div>
        
        <button onclick="testLogic()" 
            class="w-full bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600">
            æµ‹è¯•æ˜¾ç¤ºé€»è¾‘
        </button>
        
        <div id="result" class="p-4 rounded-lg border">
            <h3 class="font-medium mb-2">æµ‹è¯•ç»“æœï¼š</h3>
            <div id="resultContent" class="text-sm text-zinc-600">
                ç‚¹å‡»æµ‹è¯•æŒ‰é’®æŸ¥çœ‹ç»“æœ
            </div>
        </div>
        
        <button id="mockShareBtn" class="w-full bg-zinc-500 text-white py-2 px-4 rounded-lg hidden">
            ğŸ“¸ åˆ†äº«ç»“æœ
        </button>
    </div>

    <script>
        // æ¨¡æ‹Ÿä¼˜åŒ–åçš„æ˜¾ç¤ºé€»è¾‘
        function testShareButtonLogic(appState) {
            const validPlayers = appState.multiplayer.players.filter(p => p.name && p.name.trim() !== '');
            const playersWithWeapons = validPlayers.filter(p => p.weapon);
            
            const isAssignmentComplete = !appState.multiplayer.isAssigning;
            const hasValidPlayers = validPlayers.length > 0;
            const hasMinimumResults = playersWithWeapons.length >= Math.min(2, validPlayers.length);
            const allPlayersAssigned = validPlayers.length > 0 && playersWithWeapons.length === validPlayers.length;
            
            const shouldShow = isAssignmentComplete && hasValidPlayers && (allPlayersAssigned || hasMinimumResults);
            
            return {
                shouldShow,
                validPlayers: validPlayers.length,
                playersWithWeapons: playersWithWeapons.length,
                isAssignmentComplete,
                hasValidPlayers,
                hasMinimumResults,
                allPlayersAssigned
            };
        }
        
        function testLogic() {
            const playerCount = parseInt(document.getElementById('playerCount').value);
            const assignedCount = parseInt(document.getElementById('assignedCount').value);
            const isAssigning = document.getElementById('isAssigning').checked;
            
            // åˆ›å»ºæ¨¡æ‹ŸçŠ¶æ€
            const appState = {
                multiplayer: {
                    isAssigning,
                    players: Array.from({length: playerCount}, (_, i) => ({
                        name: `ç©å®¶${i + 1}`,
                        weapon: i < assignedCount ? { name: `æ­¦å™¨${i + 1}` } : null
                    }))
                }
            };
            
            const result = testShareButtonLogic(appState);
            const shareButton = document.getElementById('mockShareBtn');
            
            // æ›´æ–°æŒ‰é’®æ˜¾ç¤º
            shareButton.classList.toggle('hidden', !result.shouldShow);
            
            // æ˜¾ç¤ºæµ‹è¯•ç»“æœ
            document.getElementById('resultContent').innerHTML = `
                <div class="space-y-1">
                    <div><strong>æ˜¯å¦æ˜¾ç¤ºåˆ†äº«æŒ‰é’®ï¼š</strong> 
                        <span class="${result.shouldShow ? 'text-green-600' : 'text-red-600'}">
                            ${result.shouldShow ? 'æ˜¯' : 'å¦'}
                        </span>
                    </div>
                    <div><strong>æœ‰æ•ˆç©å®¶æ•°é‡ï¼š</strong> ${result.validPlayers}</div>
                    <div><strong>å·²åˆ†é…æ­¦å™¨ç©å®¶æ•°é‡ï¼š</strong> ${result.playersWithWeapons}</div>
                    <div><strong>åˆ†é…æ˜¯å¦å®Œæˆï¼š</strong> ${result.isAssignmentComplete ? 'æ˜¯' : 'å¦'}</div>
                    <div><strong>æœ‰æœ‰æ•ˆç©å®¶ï¼š</strong> ${result.hasValidPlayers ? 'æ˜¯' : 'å¦'}</div>
                    <div><strong>è¾¾åˆ°æœ€å°‘ç»“æœæ•°ï¼š</strong> ${result.hasMinimumResults ? 'æ˜¯' : 'å¦'}</div>
                    <div><strong>æ‰€æœ‰ç©å®¶å·²åˆ†é…ï¼š</strong> ${result.allPlayersAssigned ? 'æ˜¯' : 'å¦'}</div>
                </div>
            `;
        }
        
        // åˆå§‹æµ‹è¯•
        testLogic();
        
        // ç›‘å¬è¾“å…¥å˜åŒ–
        document.getElementById('playerCount').addEventListener('input', testLogic);
        document.getElementById('assignedCount').addEventListener('input', testLogic);
        document.getElementById('isAssigning').addEventListener('change', testLogic);
        
        // ç¡®ä¿åˆ†é…æ•°é‡ä¸è¶…è¿‡ç©å®¶æ•°é‡
        document.getElementById('playerCount').addEventListener('input', function() {
            const assignedInput = document.getElementById('assignedCount');
            assignedInput.max = this.value;
            if (parseInt(assignedInput.value) > parseInt(this.value)) {
                assignedInput.value = this.value;
                testLogic();
            }
        });
    </script>
</body>
</html>
